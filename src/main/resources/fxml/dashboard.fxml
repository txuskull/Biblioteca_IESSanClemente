<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.Button?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.ScrollPane?>
<?import javafx.scene.image.Image?>
<?import javafx.scene.image.ImageView?>
<?import javafx.scene.layout.BorderPane?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.Region?>
<?import javafx.scene.layout.VBox?>
<?import javafx.scene.text.Font?>

<?import javafx.scene.chart.BarChart?>
<?import javafx.scene.chart.CategoryAxis?>
<?import javafx.scene.chart.NumberAxis?>
<?import javafx.scene.chart.PieChart?>

<BorderPane xmlns="http://javafx.com/javafx" xmlns:fx="http://javafx.com/fxml"
            fx:controller="controller.DashboardController"
            stylesheets="@../css/estilos.css"
            style="-fx-background-color: white;"
            prefHeight="700" prefWidth="1200">

    <top>
        <!-- CABECERA 80px CON ALINEACIÃ“N VERTICAL CENTRADA -->
        <HBox spacing="20" alignment="CENTER"
              style="-fx-background-color: rgba(70, 141, 174, 1);"
              prefHeight="80">
            <padding>
                <Insets left="30" right="30"/>
            </padding>

            <!-- ESPACIO IZQUIERDO FLEXIBLE -->
            <Region HBox.hgrow="ALWAYS"/>

            <!-- IMAGEN PEQUEÃ‘A CENTRADA VERTICALMENTE -->
            <ImageView fitHeight="62" fitWidth="60" preserveRatio="true">
                <Image url="@../imagenes/rgb(70, 141, 174)_SIN.png"/>
            </ImageView>

            <!-- TÃTULO CENTRADO VERTICALMENTE -->
            <Label text="GestiÃ³n de Biblioteca" textFill="WHITE">
                <font>
                    <Font name="System Bold" size="28"/>
                </font>
            </Label>

            <!-- ESPACIO DERECHO FLEXIBLE -->
            <Region HBox.hgrow="ALWAYS"/>

            <!-- BOTÃ“N CERRAR SESIÃ“N CENTRADO VERTICALMENTE -->
            <Button fx:id="btnCerrarSesion" text="Cerrar SesiÃ³n"
                    onAction="#handleCerrarSesion"
                    styleClass="boton-cerrar"
                    prefHeight="35" prefWidth="130"/>
        </HBox>
    </top>

    <center>
        <HBox>
            <VBox spacing="20" minWidth="200" prefWidth="200" maxWidth="200"
                  style="-fx-background-color: #FAFAFA; -fx-border-color: #E0E0E0; -fx-border-width: 0 1 0 0;">
                <padding>
                    <Insets top="30" left="20" right="20"/>
                </padding>

                <Label text="MENU PRINCIPAL" textFill="#9E9E9E">
                    <font>
                        <Font name="System Bold" size="20"/>
                    </font>
                    <VBox.margin>
                        <Insets bottom="20"/>
                    </VBox.margin>
                </Label>

                <Button fx:id="btnCatalogo" text="ðŸ“š  Catalogo"
                        maxWidth="Infinity" prefHeight="60"
                        onAction="#handleCatalogo"
                        styleClass="boton-menu">
                    <padding>
                        <Insets left="10"/>
                    </padding>
                </Button>

                <Button fx:id="btnUsuarios" text="ðŸ‘¥  Usuarios"
                        maxWidth="Infinity" prefHeight="60"
                        onAction="#handleUsuarios"
                        styleClass="boton-menu">
                    <padding>
                        <Insets left="10"/>
                    </padding>
                </Button>

                <Button fx:id="btnPrestamos" text="ðŸ’°  Prestamos"
                        maxWidth="Infinity" prefHeight="60"
                        onAction="#handlePrestamos"
                        styleClass="boton-menu">
                    <padding>
                        <Insets left="10"/>
                    </padding>
                </Button>

                <Button fx:id="btnSanciones" text="ðŸ”¨  Sanciones"
                        maxWidth="Infinity" prefHeight="60"
                        onAction="#handleSanciones"
                        styleClass="boton-menu">
                    <padding>
                        <Insets left="10"/>
                    </padding>
                </Button>
            </VBox>

            <!-- Contenedor principal con scroll vertical -->
            <ScrollPane fitToWidth="true" style="-fx-background: rgba(239, 239, 239, 1);" HBox.hgrow="ALWAYS">

                <!-- Contenedor vertical principal de todo el dashboard -->
                <VBox spacing="30">

                    <!-- MÃ¡rgenes internos del VBox principal -->
                    <padding>
                        <Insets top="20" right="20" bottom="30" left="20"/>
                    </padding>

                    <!-- FILA 1: 3 tarjetas -->
                    <HBox spacing="20">
                        <!-- Tarjeta azul: Total TÃ­tulos -->
                        <VBox alignment="CENTER" spacing="10" prefWidth="340" prefHeight="120"
                              HBox.hgrow="ALWAYS" maxWidth="Infinity"
                              styleClass="card-base, card-azul">
                            <Label fx:id="lblTotalTitulos" text="0" textFill="WHITE">
                                <font>
                                    <Font name="System Bold" size="48"/>
                                </font>
                            </Label>
                            <Label text="TÃ­tulos de Libros" textFill="WHITE">
                                <font>
                                    <Font name="System" size="16"/>
                                </font>
                            </Label>
                        </VBox>

                        <!-- Tarjeta Total Ejemplares -->
                        <VBox alignment="CENTER" spacing="10" prefWidth="340" prefHeight="120"
                              HBox.hgrow="ALWAYS" maxWidth="Infinity"
                              styleClass="card-base, card-azul">
                            <Label fx:id="lblTotalEjemplares" text="0" textFill="WHITE">
                                <font>
                                    <Font name="System Bold" size="48"/>
                                </font>
                            </Label>
                            <Label text="Total Ejemplares" textFill="WHITE">
                                <font>
                                    <Font name="System" size="16"/>
                                </font>
                            </Label>
                        </VBox>

                        <!-- Tarjeta  Prestamos -->
                        <VBox alignment="CENTER" spacing="10" prefWidth="340" prefHeight="120"
                              HBox.hgrow="ALWAYS" maxWidth="Infinity"
                              styleClass="card-base, card-azul">
                            <Label fx:id="lblPrestamosTotales" text="0" textFill="WHITE">
                                <font>
                                    <Font name="System Bold" size="48"/>
                                </font>
                            </Label>
                            <Label text="PrÃ©stamos Totales" textFill="WHITE">
                                <font>
                                    <Font name="System" size="16"/>
                                </font>
                            </Label>
                        </VBox>
                    </HBox>

                    <!-- FILA 2: 3 tarjetas -->
                    <HBox spacing="20">
                        <!-- Tarjeta  Usuarios -->
                        <VBox alignment="CENTER" spacing="10" prefWidth="340" prefHeight="120"
                              HBox.hgrow="ALWAYS" maxWidth="Infinity"
                              styleClass="card-base, card-azul">
                            <Label fx:id="lblUsuarios" text="0" textFill="WHITE">
                                <font>
                                    <Font name="System Bold" size="48"/>
                                </font>
                            </Label>
                            <Label text="Usuarios" textFill="WHITE">
                                <font>
                                    <Font name="System" size="16"/>
                                </font>
                            </Label>
                        </VBox>

                        <!-- Tarjeta Sanciones -->
                        <VBox alignment="CENTER" spacing="10" prefWidth="340" prefHeight="120"
                              HBox.hgrow="ALWAYS" maxWidth="Infinity"
                              styleClass="card-base, card-azul">
                            <Label fx:id="lblSancionesActivas" text="0" textFill="WHITE">
                                <font>
                                    <Font name="System Bold" size="48"/>
                                </font>
                            </Label>
                            <Label text="Sanciones Activas" textFill="WHITE">
                                <font>
                                    <Font name="System" size="16"/>
                                </font>
                            </Label>
                        </VBox>

                        <!-- Tarjeta Libro MÃ¡s Prestado -->
                        <VBox alignment="CENTER" spacing="10" prefWidth="340" prefHeight="120"
                              HBox.hgrow="ALWAYS" maxWidth="Infinity"
                              styleClass="card-base, card-azul">
                            <Label fx:id="lblLibroTop" text="â€”" textFill="WHITE">
                                <font>
                                    <Font name="System Bold" size="20"/>
                                </font>
                            </Label>
                            <Label text="Libro MÃ¡s Prestado" textFill="WHITE">
                                <font>
                                    <Font name="System" size="16"/>
                                </font>
                            </Label>
                        </VBox>
                    </HBox>

                    <!-- FILA INFERIOR: grÃ¡ficos -->
                    <HBox spacing="20" alignment="CENTER_LEFT">

                        <!-- Contenedor del grÃ¡fico circular -->
                        <VBox spacing="15" prefWidth="450" prefHeight="400" HBox.hgrow="ALWAYS"
                              style="-fx-background-color: white; -fx-background-radius: 10;
                         -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.1), 10, 0, 0, 2);">

                            <padding>
                                <Insets top="20" right="20" bottom="20" left="20"/>
                            </padding>

                            <Label text="Disponibilidad de Ejemplares">
                                <font>
                                    <Font name="System Bold" size="18"/>
                                </font>
                            </Label>

                            <PieChart fx:id="pieChartDisponibilidad"
                                      prefHeight="320"
                                      VBox.vgrow="ALWAYS"/>
                        </VBox>

                        <!-- Contenedor del grÃ¡fico de barras -->
                        <VBox spacing="15" prefWidth="450" prefHeight="400" HBox.hgrow="ALWAYS"
                              style="-fx-background-color: white; -fx-background-radius: 10;
                         -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.1), 10, 0, 0, 2);">

                            <padding>
                                <Insets top="20" right="20" bottom="20" left="20"/>
                            </padding>

                            <Label text="Top 5 Libros Mas Prestados">
                                <font>
                                    <Font name="System Bold" size="18"/>
                                </font>
                            </Label>

                            <BarChart fx:id="barChartTop5"
                                      prefHeight="320"
                                      VBox.vgrow="ALWAYS">

                                <xAxis>
                                    <CategoryAxis side="BOTTOM" label="Libros"/>
                                </xAxis>

                                <yAxis>
                                    <NumberAxis side="LEFT" label="Prestamos"/>
                                </yAxis>
                            </BarChart>
                        </VBox>
                    </HBox>
                </VBox>
            </ScrollPane>

        </HBox>
    </center>
</BorderPane>